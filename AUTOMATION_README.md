# 自动化任务系统使用说明

## 功能概述

这个自动化任务系统可以实现以下功能：
1. **定时执行任务** - 可以设置每天在指定时间自动执行
2. **桌面图标匹配** - 在桌面上匹配软件图标并打开软件
3. **窗口内图片匹配** - 在打开的软件窗口中匹配目标图片
4. **自动点击** - 点击匹配到的图片位置

## 快速开始

### 1. 运行程序

```bash
java -cp target/classes yifei.automation.AutomationMain
```

或者直接运行主类 `AutomationMain`

### 2. 配置步骤

#### 步骤1: 配置定时任务（可选）
- 选择菜单选项 `1`
- 设置是否启用定时任务
- 如果启用，设置执行时间（格式：HH:mm:ss，如 14:30:00）

#### 步骤2: 配置桌面图标
- 选择菜单选项 `2`
- 输入桌面图标图片的完整路径（例如：`C:\Users\YourName\Desktop\app_icon.png`）
- 设置匹配阈值（0.0-1.0，推荐0.8）

**提示**：需要先截取桌面图标的截图保存为图片文件

#### 步骤3: 配置软件窗口
- 选择菜单选项 `3`
- 输入软件窗口标题（部分匹配即可）
- 可选：输入进程名
- 设置等待窗口出现的超时时间（秒）

#### 步骤4: 配置目标图片
- 选择菜单选项 `4`
- 输入要在软件中匹配的目标图片路径
- 设置匹配阈值（0.0-1.0，推荐0.8）

**提示**：需要先截取软件中要点击的图片保存为文件

#### 步骤5: 配置点击选项
- 选择菜单选项 `5`
- 选择是否双击
- 设置点击延迟（毫秒）

#### 步骤6: 保存配置
- 选择菜单选项 `7` 保存所有配置
- 配置会保存到 `automation_config.properties` 文件

### 3. 执行任务

#### 立即执行
- 选择菜单选项 `8` 可以立即执行一次任务（不等待定时）

#### 启动定时任务
- 选择菜单选项 `9` 启动定时任务
- 程序会保持运行，在设定的时间自动执行任务
- 按回车键可以停止定时任务并退出

## 使用示例

### 示例场景：每天14:30自动打开微信并点击某个按钮

1. **准备图片**：
   - 截取微信桌面图标，保存为 `wechat_icon.png`
   - 截取微信中要点击的按钮，保存为 `target_button.png`

2. **配置**：
   ```
   定时任务: 启用，时间 14:30:00
   桌面图标: wechat_icon.png，阈值 0.8
   软件窗口: 窗口标题 "微信"，超时 30秒
   目标图片: target_button.png，阈值 0.8
   点击选项: 单击，延迟 500毫秒
   ```

3. **启动**：
   - 保存配置
   - 选择选项9启动定时任务
   - 程序会在每天14:30自动执行

## 配置文件说明

配置文件 `automation_config.properties` 格式：

```properties
# 定时任务配置
schedule.time=14:30:00
schedule.enable=true

# 桌面图标配置
desktop.icon.path=C:/path/to/icon.png
desktop.icon.threshold=0.8

# 软件窗口配置
window.title=微信
window.process=WeChat.exe
window.timeout=30

# 目标图片配置
target.image.path=C:/path/to/target.png
target.image.threshold=0.8

# 点击配置
click.delay=500
click.double=false
```

## 注意事项

1. **图片路径**：支持绝对路径，路径中的反斜杠可以使用 `/` 或 `\\`
2. **匹配阈值**：值越高匹配越严格，推荐0.7-0.9之间
3. **窗口检测**：如果软件已经打开，可以跳过桌面图标匹配步骤（不配置图标路径）
4. **截图工具**：可以使用Windows自带的截图工具或第三方工具截取图标和目标图片
5. **权限**：程序需要屏幕截图和鼠标控制权限

## 故障排除

### 问题1: 找不到桌面图标
- 检查图标图片路径是否正确
- 尝试降低匹配阈值
- 确保桌面图标可见且未被遮挡

### 问题2: 找不到目标图片
- 检查目标图片路径是否正确
- 确保软件窗口已经打开
- 尝试降低匹配阈值
- 检查目标图片是否在当前屏幕上可见

### 问题3: 点击位置不准确
- 检查图片截图是否清晰
- 尝试调整匹配阈值
- 确保屏幕分辨率没有变化

## 技术说明

- **图像匹配**：使用OpenCV的模板匹配算法（TM_CCOEFF_NORMED）
- **屏幕控制**：使用Java AWT Robot类
- **定时任务**：使用ScheduledExecutorService实现

## 开发信息

- 开发语言：Java 8
- 依赖库：OpenCV 4.5.1-2
- 项目路径：`yifei.automation` 包

